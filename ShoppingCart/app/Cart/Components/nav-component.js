//import { module } from "angular";
var Nav;
(function (Nav) {
    'use strict';
    // import IEmitterService = Emitter.IEmitterService;
    var NavComponent = (function () {
        function NavComponent() {
            this.controller = NavController;
            this.templateUrl = 'app/Cart/Templates/nav-template.html';
        }
        return NavComponent;
    }());
    ;
    var NavController = (function () {
        function NavController(emitter, shopService, store) {
            this.emitter = emitter;
            this.shopService = shopService;
            this.store = store;
            this.items = null;
            this.itemsCount = 0;
            this.state = null;
            this.activate();
        }
        NavController.prototype.$onDestroy = function () {
            // clean up events
            this.emitter.dispose();
        };
        ;
        NavController.prototype.activate = function () {
            var _this = this;
            var self = this;
            self.items = this.store.subscribe('nav');
            this.shopService.onAdd(function (count) {
                _this.items.itemsCount += count;
            });
            var promise = this.shopService.addedToCart()
                .then(null, null, function (count) {
                // self.itemsCount += count;
            });
            this.emitter.listen('item-added', function (event) {
                _this.items.itemsCount += event.Quantity;
                console.log('item added: ' + JSON.stringify(event));
            });
        };
        NavController.$inject = ['emitterService', 'shopService', 'Store'];
        return NavController;
    }());
    angular.module('app').component('navComponent', new NavComponent());
})(Nav || (Nav = {}));
;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmF2LWNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm5hdi1jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsbUNBQW1DO0FBR25DLElBQVUsR0FBRyxDQStEWjtBQS9ERCxXQUFVLEdBQUcsRUFBQyxDQUFDO0lBRVgsWUFBWSxDQUFDO0lBRWQsb0RBQW9EO0lBRW5EO1FBS0k7WUFDSSxJQUFJLENBQUMsVUFBVSxHQUFHLGFBQWEsQ0FBQztZQUNoQyxJQUFJLENBQUMsV0FBVyxHQUFHLHNDQUFzQyxDQUFDO1FBQzlELENBQUM7UUFDTCxtQkFBQztJQUFELENBQUMsQUFURCxJQVNDO0lBQUEsQ0FBQztJQUVGO1FBT0ksdUJBQW9CLE9BQVksRUFBVSxXQUFnQixFQUFVLEtBQVU7WUFBMUQsWUFBTyxHQUFQLE9BQU8sQ0FBSztZQUFVLGdCQUFXLEdBQVgsV0FBVyxDQUFLO1lBQVUsVUFBSyxHQUFMLEtBQUssQ0FBSztZQUUxRSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztZQUNsQixJQUFJLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQztZQUNwQixJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztZQUNsQixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDcEIsQ0FBQztRQUVNLGtDQUFVLEdBQWpCO1lBQ0ksa0JBQWtCO1lBQ2xCLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDM0IsQ0FBQzs7UUFFTyxnQ0FBUSxHQUFoQjtZQUFBLGlCQXNCQztZQXBCRyxJQUFJLElBQUksR0FBRyxJQUFJLENBQUM7WUFDaEIsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUV6QyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxVQUFBLEtBQUs7Z0JBRXhCLEtBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxJQUFJLEtBQUssQ0FBQztZQUNuQyxDQUFDLENBQUMsQ0FBQztZQUVILElBQUksT0FBTyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxFQUFFO2lCQUNiLElBQUksQ0FBQyxJQUFJLEVBQUMsSUFBSSxFQUFDLFVBQVUsS0FBSztnQkFFNUIsNEJBQTRCO1lBRTFCLENBQUMsQ0FBQyxDQUFDO1lBRXRDLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxVQUFDLEtBQUs7Z0JBRXBDLEtBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxJQUFJLEtBQUssQ0FBQyxRQUFRLENBQUM7Z0JBQ3hDLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztZQUN4RCxDQUFDLENBQUMsQ0FBQztRQUNQLENBQUM7UUFyQ00scUJBQU8sR0FBRyxDQUFDLGdCQUFnQixFQUFFLGFBQWEsRUFBRSxPQUFPLENBQUMsQ0FBQztRQXNDaEUsb0JBQUM7SUFBRCxDQUFDLEFBM0NELElBMkNDO0lBRUQsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxTQUFTLENBQUMsY0FBYyxFQUFFLElBQUksWUFBWSxFQUFFLENBQUMsQ0FBQztBQUN4RSxDQUFDLEVBL0RTLEdBQUcsS0FBSCxHQUFHLFFBK0RaO0FBQUEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4vL2ltcG9ydCB7IG1vZHVsZSB9IGZyb20gXCJhbmd1bGFyXCI7XHJcblxyXG5cclxubmFtZXNwYWNlIE5hdiB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgLy8gaW1wb3J0IElFbWl0dGVyU2VydmljZSA9IEVtaXR0ZXIuSUVtaXR0ZXJTZXJ2aWNlO1xyXG5cclxuICAgIGNsYXNzIE5hdkNvbXBvbmVudCBpbXBsZW1lbnRzIG5nLklDb21wb25lbnRPcHRpb25zIHtcclxuXHJcbiAgICAgICAgcHVibGljIGNvbnRyb2xsZXI6IGFueTtcclxuICAgICAgICBwdWJsaWMgdGVtcGxhdGVVcmw6IHN0cmluZztcclxuXHJcbiAgICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlciA9IE5hdkNvbnRyb2xsZXI7XHJcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVVcmwgPSAnYXBwL0NhcnQvVGVtcGxhdGVzL25hdi10ZW1wbGF0ZS5odG1sJztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNsYXNzIE5hdkNvbnRyb2xsZXIge1xyXG5cclxuICAgICAgICBwdWJsaWMgaXRlbXM6IGFueTtcclxuICAgICAgICBwdWJsaWMgaXRlbXNDb3VudDogbnVtYmVyO1xyXG4gICAgICAgIHB1YmxpYyBzdGF0ZTogYW55O1xyXG4gICAgICAgIHN0YXRpYyAkaW5qZWN0ID0gWydlbWl0dGVyU2VydmljZScsICdzaG9wU2VydmljZScsICdTdG9yZSddO1xyXG5cclxuICAgICAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVtaXR0ZXI6IGFueSwgcHJpdmF0ZSBzaG9wU2VydmljZTogYW55LCBwcml2YXRlIHN0b3JlOiBhbnkpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zQ291bnQgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5hY3RpdmF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljICRvbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgIC8vIGNsZWFuIHVwIGV2ZW50c1xyXG4gICAgICAgICAgICB0aGlzLmVtaXR0ZXIuZGlzcG9zZSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHByaXZhdGUgYWN0aXZhdGUoKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHNlbGYuaXRlbXMgPSB0aGlzLnN0b3JlLnN1YnNjcmliZSgnbmF2Jyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNob3BTZXJ2aWNlLm9uQWRkKGNvdW50ID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLml0ZW1zQ291bnQgKz0gY291bnQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIHByb21pc2UgPSB0aGlzLnNob3BTZXJ2aWNlLmFkZGVkVG9DYXJ0KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4obnVsbCxudWxsLGZ1bmN0aW9uIChjb3VudCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZi5pdGVtc0NvdW50ICs9IGNvdW50O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZW1pdHRlci5saXN0ZW4oJ2l0ZW0tYWRkZWQnLCAoZXZlbnQpID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLml0ZW1zQ291bnQgKz0gZXZlbnQuUXVhbnRpdHk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnaXRlbSBhZGRlZDogJyArIEpTT04uc3RyaW5naWZ5KGV2ZW50KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29tcG9uZW50KCduYXZDb21wb25lbnQnLCBuZXcgTmF2Q29tcG9uZW50KCkpO1xyXG59OyAiXX0=